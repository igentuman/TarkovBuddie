<UserControl x:Class="TARKIT.Views.QuestTrackerView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:local="clr-namespace:TARKIT.Views"
             mc:Ignorable="d"
             d:DesignHeight="600" d:DesignWidth="900">
    <UserControl.Resources>
        <local:BoolToColorConverter x:Key="PinBackgroundConverter"/>
    </UserControl.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <Border Grid.Row="0" Background="#F5F5F5" BorderThickness="0,0,0,1" BorderBrush="#CCCCCC" Padding="10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="200"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <CheckBox Grid.Column="0" IsChecked="{Binding HideCompleted}" 
                          Content="Hide Completed" 
                          VerticalAlignment="Center" Margin="0,0,20,0"/>
                <CheckBox Grid.Column="1" IsChecked="{Binding OnlyKappa}" 
                          Content="Only Kappa" 
                          VerticalAlignment="Center" Margin="0,0,20,0"/>
                <TextBlock Grid.Column="2" Text="Search:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                <TextBox Grid.Column="3" Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}" 
                         VerticalAlignment="Center" Padding="5,3"/>
                <TextBlock Grid.Column="5" Text="{Binding QuestsLabel}" VerticalAlignment="Center" Margin="20,0,20,0"/>
                <TextBlock Grid.Column="6" Text="{Binding KappaLabel}" VerticalAlignment="Center" Margin="0,0,0,0"/>
            </Grid>
        </Border>

        <ScrollViewer Grid.Row="1" HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto" x:Name="QuestScrollViewer">
            <DataGrid ItemsSource="{Binding FilteredQuests}"
                      PreviewMouseWheel="DataGrid_PreviewMouseWheel" 
                      AutoGenerateColumns="False" 
                      IsReadOnly="False"
                      CanUserAddRows="False"
                      CanUserDeleteRows="False"
                      Margin="10" SelectionChanged="DataGrid_SelectionChanged">
                <DataGrid.Columns>
                    <DataGridCheckBoxColumn Header="Done" 
                                           Binding="{Binding IsCompleted, UpdateSourceTrigger=PropertyChanged}"
                                           Width="60" MinWidth="20"/>
                    <DataGridTextColumn Header="Name" 
                                       Binding="{Binding Name, Mode=OneWay}" 
                                       Width="200"
                                       IsReadOnly="True" MinWidth="200"/>
                    <DataGridTextColumn Header="Description" 
                                       Binding="{Binding ShortDescription, Mode=OneWay}" 
                                       Width="600"
                                       IsReadOnly="True"/>
                    <DataGridCheckBoxColumn Header="Kappa" 
                                           Binding="{Binding Kappa, Mode=OneWay}" 
                                           Width="60"
                                           IsReadOnly="True" MinWidth="40"/>
                    <DataGridTextColumn Header="Map" 
                                       Binding="{Binding Map, Mode=OneWay}" 
                                       Width="90"
                                       IsReadOnly="True" MinWidth="90"/>
                    <DataGridTemplateColumn Header="Pin" Width="50" MinWidth="40">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Button Content="ðŸ“Œ" 
                                        Command="{Binding DataContext.TogglePinCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                        CommandParameter="{Binding}"
                                        Padding="5,2"
                                        Background="{Binding IsPinned, Converter={StaticResource PinBackgroundConverter}}"/>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                </DataGrid.Columns>
            </DataGrid>
        </ScrollViewer>
    </Grid>
</UserControl>
